---
title: "테스트 구성 파일 관리"
date: 2022-09-13 18:28:00 +0900
fc-calendar: Gregorian Calendar
fc-date: 2022-09-13
aliases: 
tags: [yaml, spring]
categories: 
---

[[Spring framework|Spring]] 에서는 `application.yml` 및 `application-*.yml` 을 통해서 다양한 환경을 구성할 수 있다. 해당 방식을 활용해서 운영환경과 테스트 환경을 분리할 수 있다.

만약 테스트 클래스에 `@SpringBootTest` 를 명시했다면 테스트 실행시 스프링 컨테이너가 로드되고 `src/main/resources` 하위에 있는 구성 파일들을 참조할 수 있다.

`application.yml` 은 `application-*.yml` 보다 먼저 읽혀지고 `spring.profiles.active` 값에 따라 `application-*.yml` 파일의 내용을 덮어쓴다.

> [!WARNING] application.yml 은 항상 먼저 적용된다는 점에 주의하자.
>  설정을 덮어쓴다는 점에 주의할 필요가 있는데, 실무에서 JPA 사용 중 `application.yml` 에 운영 DB 가 적힌 상태로 test 를 실행시켰다가 `application-test.yml` 의 `ddl-auto` 옵션이 create 로 동작하여 운영 DB 를 모두 drop 해버리는 대참사(...)가 발생하는 것을 목격한 적이 있기 때문이다.

`application.yml` 은 항상 `dev`, `prod` 환경과는 분리한 채로 관리하는 것이 안전하며 편리하다. 그 외에 `application-test.yml` 은 test module 아래로 배치하는 것이 test 와 비즈니스 로직을 명확하게 분리할 수 있다.

## Reference

- [테스트 구성파일 관리](https://findmypiece.tistory.com/179)
