---
title: Docker Study Chapter 5
date: 2023-10-21 14:04:00 +0900
aliases: 
tags:
  - study
  - docker
  - registry
  - image
categories: Docker
updated: 2023-10-21 15:41:12 +0900
---

# Chapter 5

---

로컬 컴퓨터에 이미지를 갖고 있지 않더라도 도커가 자동으로 이미지를 내려받아 준다. 이 이미지들은 도커 레지스트리라고 불리는 서버에 저장되며, [Docker hub](https://hub.docker.com/)는 가장 유명한 레지스트리다. 도커 엔진에 기본으로 설정된 레지스트리이기도 하다.

---

이미지를 직접 관리한다면 좀 더 상세한 정보를 이미지 이름에 포함시켜야 한다. 이미지 참조가 레지스트리에서 특정한 이미지를 식별하는 식별자 역할을 하기 때문이다.

직접 애플리케이션을 패키징하려면 항상 태그를 부여해야 하며, 태그는 같은 애플리케이션의 서로 다른 버전을 구별하기 위해 쓰인다.

> [!info]
> 이미지를 빌드할 때 태그를 따로 지정하지 않으면 기본적으로 latest 태그가 부여된다.

---

### 레지스트리에 이미지를 푸시하기 위한 절차

1. 도커 CLI 를 통해 레지스트리에 로그인
2. 이미지에 푸시 권한을 가진 계정명을 포함하는 이미지 참조 붙이기

도커 아이디를 환경 변수로 관리하면 편리하다.

```bash
export dockerId="도커계정이름"
```

---

### Docker login

```bash
docker login --username $dockerId
```


> [!tip] Docker hub 의 access token 을 사용하여 로그인할 수 있다.
> password 를 직접 입력하는 것은 보안적으로 위험할 수 있기 때문에, 토큰을 사용한 로그인을 권장한다.

---

### Image Push 에서 Dockerfile 최적화가 중요한 이유

- 캐시상에 레이어 해시와 일치하는 레이어가 없을 경우에만 실제로 업로드
- 이미 최적화된 이미지를 푸시한다면 레지스트리의 캐시를 재사용
    - 네트워크 대역폭에 영향을 준다!

---

### 이미지 태그를 효율적으로 사용하기

https://semver.org/

- 예상치 못한 변경에 의한 장애를 방지하기 위해 가급적이면 정확한 버전을 지정하자
